{% load static %}

{% if user.is_authenticated %}
<div class="user-name mb-5">
    <h2 class="auth-title">Кошельки</h2>
    {% if wallets %}
        {% for wallet in wallets %}
            <div class="wallet-item mb-3">
                <div class="wallet-info">
                    <span class="fw-bold">{{ wallet.name}}</span>
                    <span> - {{ wallet.balance }} {{ wallet.get_currency_icon }}</span>
                </div>

                <div class="wallet-actions">
                    <a href="{% url 'wallet_account:wallet:update_wallet' wallet.id %}" 
                       class="btn-icon edit"
                       aria-label="Редоктировать кошелек {{ wallet.name }}">
                        <img src="{% static 'img/icons/edit.svg' %}" class="icon" width="16" height="16">
                    </a>
                    <a href="{% url 'wallet_account:wallet:delete_wallet' wallet.id %}" 
                       class="btn-icon delete text-danger" 
                       aria-label="Удалить кошелек {{ wallet.name }}">
                        <img src="{% static 'img/icons/delete.svg' %}" class="icon" width="16" height="16">
                    </a>            
                </div>
            </div>
        {% endfor %}
    {% else %}
        <p class="text center text-muted"> 
            У вас нет кошельков 
        </p>
    {% endif %}
    <a href="{% url 'wallet_account:wallet:create_wallet' %}" class="auth-btn small full-width text-center">
        Создать кошелек
    </a>

    <div class="simple-divider"></div>

    <h2 class="auth-title mb-3">Транзакции</h2>
    {% if transactions %}
        <div class="table-responsive">
            <table class="transaction-table">
                <thead>
                    <tr>
                        <th>Тип</th>
                        <th>Сумма</th>
                        <th>дата</th>
                        <th>Категория</th>
                        <th>Описание</th>
                        <th class="text-end">Действия</th>
                    </tr>
                </thead>
                <tbody>
                    {% for transaction in transactions %}
                        <tr class="{% if transaction.type == 'expense' %}text-danger{% endif %}">
                        <td>
                            <span class="badge type-{{ transaction.type }}">
                                {{ transaction.get_type_translate }}
                            </span>
                        </td>
                        <td>{{ transaction.amount }}</td>
                        <td>{{ transaction.date|date:"d.m.Y" }}</td>
                        <td>
                            {% if transaction.category %}
                                {{ transaction.category.name }}
                            {% else %}
                                <span class="text-muted">Без категории</span>
                            {% endif %}
                        </td>
                        <td class="description">
                            {{ transaction.description|truncatewords:10 }}
                        </td>
                        <td class="text-end actions">
                            <div class="btn-group">
                                <a href="{% url 'wallet_account:wallet:update_transaction' transaction.id %}"
                                    class="btn-icon edit"
                                    aria-label="Редактировать транзакцию">
                                    <img src="{% static 'img/icons/edit.svg' %}" class="icon" width="16" height="16">
                                </a>
                                <a href="{% url 'wallet_account:wallet:delete_transaction' transaction.id %}"
                                    class="btn-icon delete text-danger"
                                    aria-label="Удалить транзакцию">
                                    <img src="{% static 'img/icons/delete.svg' %}" class="icon" width="16" height="16">
                                </a>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}    
                </tbody>
            </table>
        </div>
    {% else %}
        <p class="text-center text-muted">
            У вас нет транзакций
        </p>
    {% endif %}
    
    <a href="{% url 'wallet_account:wallet:create_transaction' %}" class="auth-btn small mb-3">Добавить транзакции</a>
    <a href="{% url 'wallet_account:wallet:all_category' %}" class="auth-btn small mb-3">Посмотреть категории</a>
</div>
{% else %}
    <div class="user-name mb-5">
        <p class="text-center user-muted mb-3"> Добро пожаловать на сайт для отслеживания своего бюджета.
            Для работы с сайтом зарегестрируйте свой аккаунт или войдите в уже существующий.
        </p>
        <a href="{% url 'wallet_account:signup' %}" class="auth-btn-outline mb-3"> Регистрация аккаунта</a>
    </div>
{% endif %}